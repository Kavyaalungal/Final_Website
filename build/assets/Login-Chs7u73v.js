import{I as N,z as t,au as Z,aq as ee,r as a,ad as h,V as se,al as R,av as z,aw as D,a7 as g,ax as re,a6 as E,ay as te,ak as ae,a8 as oe,ah as ne,ai as m}from"./index-Cl6ikgVv.js";const le=N(t.jsx("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}),"Visibility"),ie=N(t.jsx("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7M2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2m4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3z"}),"VisibilityOff"),ce=""+new URL("icon infoware logo new-DFc2T_Mb.png",import.meta.url).href,de=""+new URL("liscare-website-login-page-copy-EvXX-2_G.jpg",import.meta.url).href;function me(){const q=Z(),A=ee(),[C,M]=a.useState(!1),[o,Y]=a.useState(""),[n,p]=a.useState(""),[c,x]=a.useState(""),[f,y]=a.useState(""),[P,l]=a.useState(""),[k,d]=a.useState(""),[U,u]=a.useState(""),[b,K]=a.useState(""),[S,T]=a.useState([]),[w,V]=a.useState(""),[I,$]=a.useState([]),[he,F]=a.useState(null);a.useEffect(()=>{fetch("http://172.16.16.157:8083/api/YearDataget").then(e=>e.json()).then(e=>{if(console.log(e),e.success&&Array.isArray(e.yearDetails)){const r=e.yearDetails.map(s=>({Yeardata:s.Yeardata,YearId:s.YearId}));if(T(r),console.log(r),r.length>0){const s=r[r.length-1];K(s.Yeardata),sessionStorage.setItem("latestYear",s.Yeardata),sessionStorage.setItem("latestYearId",s.YearId.toString())}}else console.error("Unexpected data format:",e)}).catch(e=>{console.error("Error fetching data:",e)})},[]),a.useEffect(()=>{fetch("http://172.16.16.157:8083/api/Branchname_Get").then(e=>e.json()).then(e=>{if(console.log("API Response:",e),e.Success&&Array.isArray(e.brnch_dlts)){const r=e.brnch_dlts.map(s=>({BranchName:s.BranchName,Branchkey:s.BranchKey}));$(r),console.log("Branch Names:",r)}else console.error("Unexpected data format:",e)}).catch(e=>{console.error("Error fetching branches:",e)})},[]),a.useEffect(()=>{const r=window.location.port.slice(-1);F(r),sessionStorage.setItem("BranchIdNow",r)},[]);const _=()=>{M(e=>!e)},G=e=>{e.preventDefault()},W=e=>{const r=e.target.value;/^[0-9]*$/.test(r)&&(Y(r),l("")),r&&(p(""),x(""),p(""),x(""),d(""),u(""))},H=e=>{p(e.target.value),d(""),e.target.value&&(Y(""),l(""))},L=e=>{sessionStorage.removeItem("username"),sessionStorage.setItem("username",e.username),sessionStorage.setItem("userId",e.Empid),sessionStorage.setItem("selectedYear",b),sessionStorage.setItem("selectedYrID",sessionStorage.getItem("selectedYrID")||""),sessionStorage.setItem("selectedBranch",w),sessionStorage.setItem("selectedBranchKey",sessionStorage.getItem("selectedBranchKey")||""),A({type:"login"}),q("/"),m.success("LOGIN SUCCESS",{autoClose:1e3,position:"top-center"})},j=()=>{let e=!0;if(y(""),w||(y("Branch is required"),e=!1),b||(m.error("Year is required"),e=!1),!o&&(!n||!c)?(o||l("EmpKey is required "),n||d("Username is required"),c||u("Password is required "),e=!1):(l(""),d(""),u("")),!!e){if(o){const r=`http://172.16.16.157:8083/api/UserLogin?Empkey=${o}`;console.log("Request URL:",r),fetch(r).then(s=>{if(console.log("Response Status:",s.status),!s.ok)throw new Error(`HTTP error! status: ${s.status}`);return s.json()}).then(s=>{console.log("API Response:",s),s.Success?(console.log("Login successful with EmpKey:",o,s.username),L(s)):(l("Invalid EmpKey. Please try again."),m.error("invalid emp key"))}).catch(s=>{console.error("Error during login:",s),l("Failed to login. Please try again later.")})}else if(n&&c){const r=`http://172.16.16.10:8060/api/UserLogin?username=${n}&password=${c}`;console.log("Request URL:",r),fetch(r).then(s=>{if(console.log("Response Status:",s.status),!s.ok)throw new Error(`HTTP error! status: ${s.status}`);return s.json()}).then(s=>{console.log("API Response:",s),s.Success?(console.log("Login successful with Username and Password:",n,s),L(s)):m.error("Invalid Username or password")}).catch(s=>{console.error("Error during login:",s),m.error("Invalid Username and Password",{autoClose:2e3,position:"top-center"})})}}},O=()=>{n?(d(""),document.getElementById("password-input").focus()):d("Username is required")},X=e=>{x(e.target.value),u(""),l("")},v=(e,r)=>{e.key==="Enter"&&(r==="empKey"&&o?j():r==="username"?O():r==="password"&&c?j():u("Password is required"))},Q=e=>{const r=e.target.value,s=S.find(B=>B.Yeardata===r),i=s==null?void 0:s.YearId;K(r),sessionStorage.setItem("selectedYear",r),sessionStorage.setItem("selectedYrID",(i==null?void 0:i.toString())||"")},J=e=>{const r=e.target.value,s=I.find(B=>B.BranchName===r),i=s==null?void 0:s.Branchkey;r&&y(""),V(r),sessionStorage.setItem("selectedBranch",r),sessionStorage.setItem("selectedBranchKey",(i==null?void 0:i.toString())||"")};return t.jsxs(h,{sx:{height:"125vh",width:"125vw",position:"fixed",top:0,left:0,backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center center",display:"flex",alignItems:"flex-end",justifyContent:"center",flexDirection:"column",margin:0,padding:0,backgroundImage:`url(${de})`},children:[t.jsxs(h,{sx:{width:{xs:"300px",sm:"300px",md:"400px"},height:"auto",padding:{xs:"10px",sm:"15px",md:"20px"},backgroundColor:"rgba(255, 255, 255, 1)",boxShadow:"0px 0px 15px rgba(0, 0, 0, 0.3)",borderRadius:"15px",transform:"translateY(-8%) scale(0.9)",marginRight:{xs:2,sm:2},marginTop:{xs:3,sm:5}},children:[t.jsx(h,{display:"flex",gap:2,children:t.jsx(se,{mb:1.5,variant:"h5",gutterBottom:!0,className:"ColorCommon",children:"Welcome"})}),t.jsxs(h,{component:"form",sx:{display:"flex",flexDirection:"column",gap:"12px"},noValidate:!0,autoComplete:"off",children:[t.jsxs(R,{fullWidth:!0,size:"small",children:[t.jsx(z,{id:"year-label",children:"Year"}),t.jsx(D,{labelId:"year-label",id:"year",value:b,onChange:Q,label:"Year",sx:{fontSize:"1rem"},children:S.length>0?S.map(e=>t.jsx(g,{value:e.Yeardata,sx:{fontSize:"0.95rem"},children:e.Yeardata},e.Yeardata)):t.jsx(g,{disabled:!0,children:"No years available"})})]}),t.jsxs(R,{fullWidth:!0,size:"small",error:!!f,children:[t.jsx(z,{id:"branch-label",children:"Branch"}),t.jsx(D,{labelId:"branch-label",id:"branch",value:w,onChange:J,label:"Branch",sx:{fontSize:"1rem"},children:I.length>0?I.map(e=>t.jsx(g,{value:e.BranchName,sx:{fontSize:"0.75rem",height:"30px",padding:"4px 8px"},children:e.BranchName},e.BranchName)):t.jsx(g,{disabled:!0,children:"No branches available"})}),f&&t.jsx(re,{children:f})]}),t.jsx(E,{label:P||"Empkey",size:"small",variant:"outlined",value:o,onChange:W,error:!!P,onKeyDown:e=>v(e,"empKey")}),t.jsx(E,{label:k||"Username",size:"small",variant:"outlined",value:n,onChange:H,error:!!k,onKeyDown:e=>v(e,"username"),sx:{marginBottom:"0px"},autoComplete:"username"}),t.jsx(E,{id:"password-input",label:U||"Password",type:C?"text":"password",size:"small",variant:"outlined",value:c,onChange:X,error:!!U,onKeyDown:e=>v(e,"password"),autoComplete:"current-password",InputProps:{endAdornment:t.jsx(te,{position:"end",children:t.jsx(ae,{"aria-label":"toggle password visibility",onClick:_,onMouseDown:G,edge:"end",children:C?t.jsx(le,{}):t.jsx(ie,{})})})}}),t.jsx(h,{sx:{display:"flex",justifyContent:"flex-end",gap:1},children:t.jsx(oe,{size:"small",variant:"contained",sx:{backgroundColor:"#bb4d58","&:hover":{backgroundColor:"#bd2937",boxShadow:"0px 4px 8px rgba(0, 0, 0, 0.2)"}},onClick:j,children:"Login"})})]})]}),t.jsx(h,{sx:{position:"fixed",bottom:10,right:10,zIndex:1e3,transform:"scale(0.8)"},children:t.jsx("a",{href:"https://iconinfoware.com/",target:"_blank",rel:"noopener noreferrer",children:t.jsx("img",{src:ce,alt:"Logo",style:{maxWidth:"18%",height:"auto",marginLeft:1500}})})}),t.jsx(ne,{autoClose:3e3,hideProgressBar:!0})]})}export{me as default};
