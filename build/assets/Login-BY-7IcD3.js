import{j as t,l as Q,i as J,r as a}from"./index-D60ulZa2.js";import{z as D,a8 as c,a2 as Z,ad as R,ae as k,af as L,ac as m,ab as S,aj as ee,Y as se,aa as te,ah as re,ai as u}from"./react-toastify.esm-UvMY957B.js";const ae=D(t.jsx("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}),"Visibility"),ne=D(t.jsx("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7M2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2m4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3z"}),"VisibilityOff"),oe=""+new URL("icon infoware logo new-DFc2T_Mb.png",import.meta.url).href,le=""+new URL("liscare-website-login-page-copy-EvXX-2_G.jpg",import.meta.url).href;function he(){const z=Q(),N=J(),[b,T]=a.useState(!1),[n,I]=a.useState(""),[o,j]=a.useState(""),[i,v]=a.useState(""),[B,d]=a.useState(""),[C,h]=a.useState(""),[E,g]=a.useState(""),[Y,P]=a.useState(""),[p,A]=a.useState([]),[U,M]=a.useState(""),[x,q]=a.useState([]),[ie,$]=a.useState(null);a.useEffect(()=>{fetch("http://172.16.16.157:8083/api/YearDataget").then(e=>e.json()).then(e=>{if(console.log(e),e.success&&Array.isArray(e.yearDetails)){const s=e.yearDetails.map(r=>({Yeardata:r.Yeardata,YearId:r.YearId}));if(A(s),console.log(s),s.length>0){const r=s[s.length-1];P(r.Yeardata),sessionStorage.setItem("latestYear",r.Yeardata),sessionStorage.setItem("latestYearId",r.YearId.toString())}}else console.error("Unexpected data format:",e)}).catch(e=>{console.error("Error fetching data:",e)})},[]),a.useEffect(()=>{fetch("http://172.16.16.157:8083/api/Branchname_Get").then(e=>e.json()).then(e=>{if(console.log("API Response:",e),e.Success&&Array.isArray(e.brnch_dlts)){const s=e.brnch_dlts.map(r=>({BranchName:r.BranchName,Branchkey:r.BranchKey}));q(s),console.log("Branch Names:",s)}else console.error("Unexpected data format:",e)}).catch(e=>{console.error("Error fetching branches:",e)})},[]),a.useEffect(()=>{const s=window.location.port.slice(-1);$(s),sessionStorage.setItem("BranchIdNow",s)},[]);const _=()=>{T(e=>!e)},F=e=>{e.preventDefault()},G=e=>{const s=e.target.value;/^[0-9]*$/.test(s)&&(I(s),d("")),s&&(j(""),v(""))},V=e=>{j(e.target.value),h(""),e.target.value&&I("")},K=e=>{sessionStorage.removeItem("username"),sessionStorage.setItem("username",e.username),sessionStorage.setItem("userId",e.Empid),sessionStorage.setItem("selectedYear",Y),sessionStorage.setItem("selectedYrID",sessionStorage.getItem("selectedYrID")||""),sessionStorage.setItem("selectedBranch",U),sessionStorage.setItem("selectedBranchKey",sessionStorage.getItem("selectedBranchKey")||""),N({type:"login"}),z("/"),u.success("LOGIN SUCCESS",{autoClose:1e3,position:"top-center"})},f=()=>{if(n){const e=`http://172.16.16.157:8083/api/UserLogin?Empkey=${n}`;console.log("Request URL:",e),fetch(e).then(s=>{if(console.log("Response Status:",s.status),!s.ok)throw new Error(`HTTP error! status: ${s.status}`);return s.json()}).then(s=>{console.log("API Response:",s),s.Success?(console.log("Login successful with EmpKey:",n,s.username),K(s)):(d("Invalid EmpKey. Please try again."),u.error("invalid emp key"))}).catch(s=>{console.error("Error during login:",s),d("Failed to login. Please try again later.")})}else if(o&&i){const e=`http://172.16.16.10:8060/api/UserLogin?username=${o}&password=${i}`;console.log("Request URL:",e),fetch(e).then(s=>{if(console.log("Response Status:",s.status),!s.ok)throw new Error(`HTTP error! status: ${s.status}`);return s.json()}).then(s=>{console.log("API Response:",s),s.Success?(console.log("Login successful with Username and Password:",o,s),K(s)):u.error("Invalid Username or password")}).catch(s=>{console.error("Error during login:",s),u.error("Invalid Username and Password",{autoClose:2e3,position:"top-center"})})}else!n&&(!o||!i)&&(o||h("Username is required"),i||g("Password is required"),n||d("EmpKey is required"))},W=()=>{o?(h(""),document.getElementById("password-input").focus()):h("Username is required")},O=e=>{v(e.target.value),g("")},y=(e,s)=>{e.key==="Enter"&&(s==="empKey"&&n?f():s==="username"?W():s==="password"&&i?f():g("Password is required"))},H=e=>{const s=e.target.value,r=p.find(w=>w.Yeardata===s),l=r==null?void 0:r.YearId;P(s),sessionStorage.setItem("selectedYear",s),sessionStorage.setItem("selectedYrID",(l==null?void 0:l.toString())||"")},X=e=>{const s=e.target.value,r=x.find(w=>w.BranchName===s),l=r==null?void 0:r.Branchkey;M(s),sessionStorage.setItem("selectedBranch",s),sessionStorage.setItem("selectedBranchKey",(l==null?void 0:l.toString())||"")};return t.jsxs(c,{sx:{height:"125vh",width:"125vw",position:"fixed",top:0,left:0,backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center center",display:"flex",alignItems:"flex-end",justifyContent:"center",flexDirection:"column",margin:0,padding:0,backgroundImage:`url(${le})`},children:[t.jsxs(c,{sx:{width:{xs:"300px",sm:"300px",md:"400px"},height:{xs:"380px",sm:"380px",md:"380px"},padding:{xs:"10px",sm:"15px",md:"20px"},backgroundColor:"rgba(255, 255, 255, 1)",boxShadow:"0px 0px 15px rgba(0, 0, 0, 0.3)",borderRadius:"15px",transform:"translateY(-10%) scale(0.7)",marginRight:{xs:2,sm:2},marginTop:{xs:3,sm:5}},children:[t.jsx(c,{display:"flex",gap:2,children:t.jsx(Z,{mb:1.5,variant:"h5",gutterBottom:!0,className:"ColorCommon",children:"Welcome"})}),t.jsxs(c,{component:"form",sx:{display:"flex",flexDirection:"column",gap:"12px"},noValidate:!0,autoComplete:"off",children:[t.jsxs(R,{fullWidth:!0,size:"small",children:[t.jsx(k,{id:"year-label",children:"Year"}),t.jsx(L,{labelId:"year-label",id:"year",value:Y,onChange:H,label:"Year",sx:{fontSize:"1rem"},children:p.length>0?p.map(e=>t.jsx(m,{value:e.Yeardata,sx:{fontSize:"0.95rem"},children:e.Yeardata},e.Yeardata)):t.jsx(m,{disabled:!0,children:"No years available"})})]}),t.jsxs(R,{fullWidth:!0,size:"small",children:[t.jsx(k,{id:"branch-label",children:"Branch"}),t.jsx(L,{labelId:"branch-label",id:"branch",value:U,onChange:X,label:"Branch",sx:{fontSize:"1rem"},children:x.length>0?x.map(e=>t.jsx(m,{value:e.BranchName,sx:{fontSize:"0.75rem"},children:e.BranchName},e.BranchName)):t.jsx(m,{disabled:!0,children:"No branches available"})})]}),t.jsx(S,{label:"Emp Key",size:"small",variant:"outlined",value:n,onChange:G,error:!!B,helperText:B,onKeyDown:e=>y(e,"empKey")}),t.jsx(S,{label:"Username",size:"small",variant:"outlined",value:o,onChange:V,error:!!C,helperText:C,onKeyDown:e=>y(e,"username"),sx:{marginBottom:"0px"},autoComplete:"username"}),t.jsx(S,{id:"password-input",label:"Password",type:b?"text":"password",size:"small",variant:"outlined",value:i,onChange:O,error:!!E,helperText:E,onKeyDown:e=>y(e,"password"),autoComplete:"current-password",InputProps:{endAdornment:t.jsx(ee,{position:"end",children:t.jsx(se,{"aria-label":"toggle password visibility",onClick:_,onMouseDown:F,edge:"end",children:b?t.jsx(ae,{}):t.jsx(ne,{})})})}}),t.jsx(c,{sx:{display:"flex",justifyContent:"flex-end",gap:1},children:t.jsx(te,{size:"small",variant:"contained",sx:{backgroundColor:"#bd2937",color:"white"},onClick:f,children:"Login"})})]})]}),t.jsx(c,{sx:{width:{xs:"250px",sm:"250px",md:"250px"},height:"0px",display:"flex",justifyContent:"center",alignItems:"center",mb:0,transform:"scale(0.8)",marginRight:{xs:4,sm:4,md:4},marginTop:6},children:t.jsx("a",{href:"https://iconinfoware.com/",target:"_blank",rel:"noopener noreferrer",children:t.jsx("img",{src:oe,alt:"Logo",style:{maxWidth:"90%",height:"auto",marginLeft:-10,marginTop:280}})})}),t.jsx(re,{autoClose:3e3,hideProgressBar:!0})]})}export{he as default};
