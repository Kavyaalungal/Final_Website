import{I as A,z as a,ab as ee,av as se,r as t,a7 as g,a6 as u,X as re,aq as z,az as D,aA as N,ad as p,aB as ae,ac as E,aC as te,ap as oe,ae as ne,al as le,aa as m}from"./index-DDP7q4-X.js";const ie=A(a.jsx("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}),"Visibility"),ce=A(a.jsx("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7M2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2m4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3z"}),"VisibilityOff"),de=""+new URL("icon infoware logo new-DFc2T_Mb.png",import.meta.url).href,ue=""+new URL("liscare-website-login-page-copy-EvXX-2_G.jpg",import.meta.url).href;function ge(){const $=ee(),q=se(),[Y,M]=t.useState(!1),[o,P]=t.useState(""),[n,x]=t.useState(""),[c,f]=t.useState(""),[b,y]=t.useState(""),[U,l]=t.useState(""),[k,d]=t.useState(""),[K,h]=t.useState(""),[S,L]=t.useState(""),[w,T]=t.useState([]),[I,_]=t.useState(""),[j,F]=t.useState([]),[he,V]=t.useState(null);t.useEffect(()=>{fetch(`${g.public_apiUrl}/YearDataget`).then(e=>e.json()).then(e=>{if(console.log(e),e.success&&Array.isArray(e.yearDetails)){const r=e.yearDetails.map(s=>({Yeardata:s.Yeardata,YearId:s.YearId}));if(T(r),console.log(r),r.length>0){const s=r[r.length-1];L(s.Yeardata),sessionStorage.setItem("latestYear",s.Yeardata),sessionStorage.setItem("latestYearId",s.YearId.toString())}}else console.error("Unexpected data format:",e)}).catch(e=>{console.error("Error fetching data:",e)})},[]),t.useEffect(()=>{fetch(`${g.public_apiUrl}/Branchname_Get`).then(e=>e.json()).then(e=>{if(console.log("API Response:",e),e.Success&&Array.isArray(e.brnch_dlts)){const r=e.brnch_dlts.map(s=>({BranchName:s.BranchName,Branchkey:s.BranchKey}));F(r),console.log("Branch Names:",r)}else console.error("Unexpected data format:",e)}).catch(e=>{console.error("Error fetching branches:",e)})},[]),t.useEffect(()=>{const r=window.location.port.slice(-1);V(r),sessionStorage.setItem("BranchIdNow",r)},[]);const G=()=>{M(e=>!e)},W=e=>{e.preventDefault()},H=e=>{const r=e.target.value;/^[0-9]*$/.test(r)&&(P(r),l("")),r&&(x(""),f(""),x(""),f(""),d(""),h(""))},O=e=>{x(e.target.value),d(""),e.target.value&&(P(""),l(""))},R=e=>{sessionStorage.removeItem("username"),sessionStorage.setItem("username",e.username),sessionStorage.setItem("userId",e.Empid),sessionStorage.setItem("selectedYear",S),sessionStorage.setItem("selectedYrID",sessionStorage.getItem("selectedYrID")||""),sessionStorage.setItem("selectedBranch",I),sessionStorage.setItem("selectedBranchKey",sessionStorage.getItem("selectedBranchKey")||""),q({type:"login"}),$("/"),m.success("LOGIN SUCCESS",{autoClose:1e3,position:"top-center"})},v=()=>{let e=!0;if(y(""),I||(y("Branch is required"),e=!1),S||(m.error("Year is required"),e=!1),!o&&(!n||!c)?(o||l("EmpKey is required "),n||d("Username is required"),c||h("Password is required "),e=!1):(l(""),d(""),h("")),!!e){if(o){const r=`${g.public_apiUrl}/UserLogin?Empkey=${o}`;console.log("Request URL:",r),fetch(r).then(s=>{if(console.log("Response Status:",s.status),!s.ok)throw new Error(`HTTP error! status: ${s.status}`);return s.json()}).then(s=>{console.log("API Response:",s),s.Success?(console.log("Login successful with EmpKey:",o,s.username),R(s)):(l("Invalid EmpKey. Please try again."),m.error("invalid emp key"))}).catch(s=>{console.error("Error during login:",s),l("Failed to login. Please try again later.")})}else if(n&&c){const r=`${g.public_apiUrl}/UserLogin?username=${n}&password=${c}`;console.log("Request URL:",r),fetch(r).then(s=>{if(console.log("Response Status:",s.status),!s.ok)throw new Error(`HTTP error! status: ${s.status}`);return s.json()}).then(s=>{console.log("API Response:",s),s.Success?(console.log("Login successful with Username and Password:",n,s),R(s)):m.error("Invalid Username or password")}).catch(s=>{console.error("Error during login:",s),m.error("Invalid Username and Password",{autoClose:2e3,position:"top-center"})})}}},X=()=>{n?(d(""),document.getElementById("password-input").focus()):d("Username is required")},Q=e=>{f(e.target.value),h(""),l("")},B=(e,r)=>{e.key==="Enter"&&(r==="empKey"&&o?v():r==="username"?X():r==="password"&&c?v():h("Password is required"))},J=e=>{const r=e.target.value,s=w.find(C=>C.Yeardata===r),i=s==null?void 0:s.YearId;L(r),sessionStorage.setItem("selectedYear",r),sessionStorage.setItem("selectedYrID",(i==null?void 0:i.toString())||"")},Z=e=>{const r=e.target.value,s=j.find(C=>C.BranchName===r),i=s==null?void 0:s.Branchkey;r&&y(""),_(r),sessionStorage.setItem("selectedBranch",r),sessionStorage.setItem("selectedBranchKey",(i==null?void 0:i.toString())||"")};return a.jsxs(u,{sx:{height:"125vh",width:"125vw",position:"fixed",top:0,left:0,backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center center",display:"flex",alignItems:"flex-end",justifyContent:"center",flexDirection:"column",margin:0,padding:0,backgroundImage:`url(${ue})`},children:[a.jsxs(u,{sx:{width:{xs:"300px",sm:"300px",md:"400px"},height:"auto",padding:{xs:"10px",sm:"15px",md:"20px"},backgroundColor:"rgba(255, 255, 255, 1)",boxShadow:"0px 0px 15px rgba(0, 0, 0, 0.3)",borderRadius:"15px",transform:"translateY(-8%) scale(0.9)",marginRight:{xs:2,sm:2},marginTop:{xs:3,sm:5}},children:[a.jsx(u,{display:"flex",gap:2,children:a.jsx(re,{mb:1.5,variant:"h5",gutterBottom:!0,className:"ColorCommon",children:"Welcome"})}),a.jsxs(u,{component:"form",sx:{display:"flex",flexDirection:"column",gap:"12px"},noValidate:!0,autoComplete:"off",children:[a.jsxs(z,{fullWidth:!0,size:"small",children:[a.jsx(D,{id:"year-label",children:"Year"}),a.jsx(N,{labelId:"year-label",id:"year",value:S,onChange:J,label:"Year",sx:{fontSize:"1rem"},children:w.length>0?w.map(e=>a.jsx(p,{value:e.Yeardata,sx:{fontSize:"0.95rem"},children:e.Yeardata},e.Yeardata)):a.jsx(p,{disabled:!0,children:"No years available"})})]}),a.jsxs(z,{fullWidth:!0,size:"small",error:!!b,children:[a.jsx(D,{id:"branch-label",children:"Branch"}),a.jsx(N,{labelId:"branch-label",id:"branch",value:I,onChange:Z,label:"Branch",sx:{fontSize:"1rem"},children:j.length>0?j.map(e=>a.jsx(p,{value:e.BranchName,sx:{fontSize:"0.75rem",height:"30px",padding:"4px 8px"},children:e.BranchName},e.BranchName)):a.jsx(p,{disabled:!0,children:"No branches available"})}),b&&a.jsx(ae,{children:b})]}),a.jsx(E,{label:U||"Empkey",size:"small",variant:"outlined",value:o,onChange:H,error:!!U,onKeyDown:e=>B(e,"empKey")}),a.jsx(E,{label:k||"Username",size:"small",variant:"outlined",value:n,onChange:O,error:!!k,onKeyDown:e=>B(e,"username"),sx:{marginBottom:"0px"},autoComplete:"username"}),a.jsx(E,{id:"password-input",label:K||"Password",type:Y?"text":"password",size:"small",variant:"outlined",value:c,onChange:Q,error:!!K,onKeyDown:e=>B(e,"password"),autoComplete:"current-password",InputProps:{endAdornment:a.jsx(te,{position:"end",children:a.jsx(oe,{"aria-label":"toggle password visibility",onClick:G,onMouseDown:W,edge:"end",children:Y?a.jsx(ie,{}):a.jsx(ce,{})})})}}),a.jsx(u,{sx:{display:"flex",justifyContent:"flex-end",gap:1},children:a.jsx(ne,{size:"small",variant:"contained",sx:{backgroundColor:"#bb4d58","&:hover":{backgroundColor:"#bd2937",boxShadow:"0px 4px 8px rgba(0, 0, 0, 0.2)"}},onClick:v,children:"Login"})})]})]}),a.jsx(u,{sx:{position:"fixed",bottom:10,right:10,zIndex:1e3,transform:"scale(0.8)"},children:a.jsx("img",{src:de,alt:"Logo",style:{maxWidth:"18%",height:"auto",marginLeft:1500}})}),a.jsx(le,{autoClose:3e3,hideProgressBar:!0})]})}export{ge as default};
