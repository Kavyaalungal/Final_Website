import{j as t,u as Q,n as J,r as a,Q as Z,B as h}from"./index-DwsJ3HCR.js";import{y as D,af as u,a1 as ee,ac as K,ad as L,ae as R,aa as g,a9 as v,ab as se,X as re,a7 as te}from"./TextField-CJOeZrSy.js";const ae=D(t.jsx("path",{d:"M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5M12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}),"Visibility"),oe=D(t.jsx("path",{d:"M12 7c2.76 0 5 2.24 5 5 0 .65-.13 1.26-.36 1.83l2.92 2.92c1.51-1.26 2.7-2.89 3.43-4.75-1.73-4.39-6-7.5-11-7.5-1.4 0-2.74.25-3.98.7l2.16 2.16C10.74 7.13 11.35 7 12 7M2 4.27l2.28 2.28.46.46C3.08 8.3 1.78 10.02 1 12c1.73 4.39 6 7.5 11 7.5 1.55 0 3.03-.3 4.38-.84l.42.42L19.73 22 21 20.73 3.27 3zM7.53 9.8l1.55 1.55c-.05.21-.08.43-.08.65 0 1.66 1.34 3 3 3 .22 0 .44-.03.65-.08l1.55 1.55c-.67.33-1.41.53-2.2.53-2.76 0-5-2.24-5-5 0-.79.2-1.53.53-2.2m4.31-.78 3.15 3.15.02-.16c0-1.66-1.34-3-3-3z"}),"VisibilityOff"),ne=""+new URL("icon infoware logo new-DFc2T_Mb.png",import.meta.url).href,le=""+new URL("liscare-website-login-page-copy-EvXX-2_G.jpg",import.meta.url).href;function he(){const z=Q(),N=J(),[B,A]=a.useState(!1),[o,C]=a.useState(""),[n,p]=a.useState(""),[c,f]=a.useState(""),[E,l]=a.useState(""),[Y,d]=a.useState(""),[P,m]=a.useState(""),[x,k]=a.useState(""),[y,q]=a.useState([]),[b,M]=a.useState(""),[S,T]=a.useState([]),[ie,$]=a.useState(null);a.useEffect(()=>{fetch("http://172.16.16.157:8083/api/YearDataget").then(e=>e.json()).then(e=>{if(console.log(e),e.success&&Array.isArray(e.yearDetails)){const r=e.yearDetails.map(s=>({Yeardata:s.Yeardata,YearId:s.YearId}));if(q(r),console.log(r),r.length>0){const s=r[r.length-1];k(s.Yeardata),sessionStorage.setItem("latestYear",s.Yeardata),sessionStorage.setItem("latestYearId",s.YearId.toString())}}else console.error("Unexpected data format:",e)}).catch(e=>{console.error("Error fetching data:",e)})},[]),a.useEffect(()=>{fetch("http://172.16.16.157:8083/api/Branchname_Get").then(e=>e.json()).then(e=>{if(console.log("API Response:",e),e.Success&&Array.isArray(e.brnch_dlts)){const r=e.brnch_dlts.map(s=>({BranchName:s.BranchName,Branchkey:s.BranchKey}));T(r),console.log("Branch Names:",r)}else console.error("Unexpected data format:",e)}).catch(e=>{console.error("Error fetching branches:",e)})},[]),a.useEffect(()=>{const r=window.location.port.slice(-1);$(r),sessionStorage.setItem("BranchIdNow",r)},[]);const V=()=>{A(e=>!e)},_=e=>{e.preventDefault()},F=e=>{const r=e.target.value;/^[0-9]*$/.test(r)&&(C(r),l("")),r&&(p(""),f(""),p(""),f(""),d(""),m(""))},G=e=>{p(e.target.value),d(""),e.target.value&&(C(""),l(""))},U=e=>{sessionStorage.removeItem("username"),sessionStorage.setItem("username",e.username),sessionStorage.setItem("userId",e.Empid),sessionStorage.setItem("selectedYear",x),sessionStorage.setItem("selectedYrID",sessionStorage.getItem("selectedYrID")||""),sessionStorage.setItem("selectedBranch",b),sessionStorage.setItem("selectedBranchKey",sessionStorage.getItem("selectedBranchKey")||""),N({type:"login"}),z("/"),h.success("LOGIN SUCCESS",{autoClose:1e3,position:"top-center"})},w=()=>{let e=!0;if(b||(h.error("Branch is required"),e=!1),x||(h.error("Year is required"),e=!1),!o&&(!n||!c)?(o||l("EmpKey is required "),n||d("Username is required"),c||m("Password is required "),e=!1):(l(""),d(""),m("")),!!e){if(o){const r=`http://172.16.16.157:8083/api/UserLogin?Empkey=${o}`;console.log("Request URL:",r),fetch(r).then(s=>{if(console.log("Response Status:",s.status),!s.ok)throw new Error(`HTTP error! status: ${s.status}`);return s.json()}).then(s=>{console.log("API Response:",s),s.Success?(console.log("Login successful with EmpKey:",o,s.username),U(s)):(l("Invalid EmpKey. Please try again."),h.error("invalid emp key"))}).catch(s=>{console.error("Error during login:",s),l("Failed to login. Please try again later.")})}else if(n&&c){const r=`http://172.16.16.10:8060/api/UserLogin?username=${n}&password=${c}`;console.log("Request URL:",r),fetch(r).then(s=>{if(console.log("Response Status:",s.status),!s.ok)throw new Error(`HTTP error! status: ${s.status}`);return s.json()}).then(s=>{console.log("API Response:",s),s.Success?(console.log("Login successful with Username and Password:",n,s),U(s)):h.error("Invalid Username or password")}).catch(s=>{console.error("Error during login:",s),h.error("Invalid Username and Password",{autoClose:2e3,position:"top-center"})})}}},W=()=>{n?(d(""),document.getElementById("password-input").focus()):d("Username is required")},O=e=>{f(e.target.value),m(""),l("")},I=(e,r)=>{e.key==="Enter"&&(r==="empKey"&&o?w():r==="username"?W():r==="password"&&c?w():m("Password is required"))},X=e=>{const r=e.target.value,s=y.find(j=>j.Yeardata===r),i=s==null?void 0:s.YearId;k(r),sessionStorage.setItem("selectedYear",r),sessionStorage.setItem("selectedYrID",(i==null?void 0:i.toString())||"")},H=e=>{const r=e.target.value,s=S.find(j=>j.BranchName===r),i=s==null?void 0:s.Branchkey;M(r),sessionStorage.setItem("selectedBranch",r),sessionStorage.setItem("selectedBranchKey",(i==null?void 0:i.toString())||"")};return t.jsxs(u,{sx:{height:"125vh",width:"125vw",position:"fixed",top:0,left:0,backgroundSize:"cover",backgroundRepeat:"no-repeat",backgroundPosition:"center center",display:"flex",alignItems:"flex-end",justifyContent:"center",flexDirection:"column",margin:0,padding:0,backgroundImage:`url(${le})`},children:[t.jsxs(u,{sx:{width:{xs:"300px",sm:"300px",md:"400px"},height:"auto",padding:{xs:"10px",sm:"15px",md:"20px"},backgroundColor:"rgba(255, 255, 255, 1)",boxShadow:"0px 0px 15px rgba(0, 0, 0, 0.3)",borderRadius:"15px",transform:"translateY(-8%) scale(0.9)",marginRight:{xs:2,sm:2},marginTop:{xs:3,sm:5}},children:[t.jsx(u,{display:"flex",gap:2,children:t.jsx(ee,{mb:1.5,variant:"h5",gutterBottom:!0,className:"ColorCommon",children:"Welcome"})}),t.jsxs(u,{component:"form",sx:{display:"flex",flexDirection:"column",gap:"12px"},noValidate:!0,autoComplete:"off",children:[t.jsxs(K,{fullWidth:!0,size:"small",children:[t.jsx(L,{id:"year-label",children:"Year"}),t.jsx(R,{labelId:"year-label",id:"year",value:x,onChange:X,label:"Year",sx:{fontSize:"1rem"},children:y.length>0?y.map(e=>t.jsx(g,{value:e.Yeardata,sx:{fontSize:"0.95rem"},children:e.Yeardata},e.Yeardata)):t.jsx(g,{disabled:!0,children:"No years available"})})]}),t.jsxs(K,{fullWidth:!0,size:"small",children:[t.jsx(L,{id:"branch-label",children:"Branch"}),t.jsx(R,{labelId:"branch-label",id:"branch",value:b,onChange:H,label:"Branch",sx:{fontSize:"1rem"},children:S.length>0?S.map(e=>t.jsx(g,{value:e.BranchName,sx:{fontSize:"0.75rem"},children:e.BranchName},e.BranchName)):t.jsx(g,{disabled:!0,children:"No branches available"})})]}),t.jsx(v,{label:E||"Empkey",size:"small",variant:"outlined",value:o,onChange:F,error:!!E,onKeyDown:e=>I(e,"empKey")}),t.jsx(v,{label:Y||"Username",size:"small",variant:"outlined",value:n,onChange:G,error:!!Y,onKeyDown:e=>I(e,"username"),sx:{marginBottom:"0px"},autoComplete:"username"}),t.jsx(v,{id:"password-input",label:P||"Password",type:B?"text":"password",size:"small",variant:"outlined",value:c,onChange:O,error:!!P,onKeyDown:e=>I(e,"password"),autoComplete:"current-password",InputProps:{endAdornment:t.jsx(se,{position:"end",children:t.jsx(re,{"aria-label":"toggle password visibility",onClick:V,onMouseDown:_,edge:"end",children:B?t.jsx(ae,{}):t.jsx(oe,{})})})}}),t.jsx(u,{sx:{display:"flex",justifyContent:"flex-end",gap:1},children:t.jsx(te,{size:"small",variant:"contained",sx:{backgroundColor:"#bb4d58","&:hover":{backgroundColor:"#bd2937",boxShadow:"0px 4px 8px rgba(0, 0, 0, 0.2)"}},onClick:w,children:"Login"})})]})]}),t.jsx(u,{sx:{position:"fixed",bottom:10,right:10,zIndex:1e3,transform:"scale(0.8)"},children:t.jsx("a",{href:"https://iconinfoware.com/",target:"_blank",rel:"noopener noreferrer",children:t.jsx("img",{src:ne,alt:"Logo",style:{maxWidth:"18%",height:"auto",marginLeft:1500}})})}),t.jsx(Z,{autoClose:3e3,hideProgressBar:!0})]})}export{he as default};
